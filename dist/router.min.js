!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Router=t()}(this,function(){"use strict";function e(t,n,i){for(var r=0,a=n.length;a>r;r++){var c=n[r];if(!o(c))return;for(var l=Object.keys(c),s=0,u=l.length;u>s;s++){var h=l[s],f=c[h];o(f)&&i?(o(t[h])||(t[h]=Array.isArray(f)?[]:{}),e(t[h],[f],!0)):t[h]=f}}return t}function t(t,n){return e(t,[n],!1)}function n(t,n){return e(t,[n],!0)}function o(e){return null!==e&&"object"==typeof e}function i(e){e.routes={},e.config=t({},k),e.cachedPath=[],window.LodeVar=window.LodeVar||{}}function r(t,o){return o&&("undefined"!=typeof o.DEBUG&&(U=n({},{DEBUG:o.DEBUG})),delete o.DEBUG,o.loggingLevel&&(o.loggingLevel=o.loggingLevel.toUpperCase()),t.config=e({},[t.config,o],!0)),t.config}function a(){D&&U.DEBUG&&(console[G?"groupCollapsed":"log"].apply(console,O),console.log(P),G&&console.groupEnd(O))}function c(e,t){B.warn("Route "+e+" of "+t+" not found.")}function l(e){for(var t=this.cachedPath,n=t.length;n--;){var o=Object.keys(t[n])[0];-1===e.indexOf(o)&&(t[n][o].active=!1,t.splice(n,1))}}function s(e,t){var n={};t.shift();for(var o=0,i=t.length;i>o;o++)n[t[o].split("/")[0].replace(/\//g,"")]=e.match(/[^\/]*/g)[0!==o?o+o:o];return n}function u(e,t){"undefined"!=typeof this.userNotFound&&this.userNotFound(),c(e,t)}function h(e){return e}function f(e){if(""===e&&(e="/"),e)for(var t=this.routes,n=!1,o=e,i=!1,r="",a=!1,c=[];e.length;){var f={};for(var d in t){var g=!1;if(r=d,d.indexOf(":")>-1){var p=d.split(":");p.length>2?(f=s(e,p),g=d.replace(/\:[^\/]*/g,"[^\\/]*")):(f[d.match(/\:[^\/]*/g)[0].replace(/(\:|\/)/g,"")]=e.match(/[^\/]*/)[0],g=d.replace(/\*[^\/]*/g,"").replace(/\:[^\/]*/g,"[^\\/]*"))}if(d.match(/\*[a-z]+/i)&&(f[d.match(/\*[a-z]+/i)[0].replace(/\*/gi,"")]=e.replace(new RegExp(g),"").match(/.*/)[0].split("/"),g=".*"),a=e.match("^"+(g||d)),i=a&&0===e.replace(a[0],"").replace(/^\//,"").replace(/\/$/,"").length?!0:!1,e.length&&a){var w={};w[d]=t[d],c.push(d),this.cachedPath.push(w),t[d].active||i||(t[d].routeData=f,t[d].active=!0,n&&(t[d].getParent=function(){return h(n)}),t[d].controller()),e=e.replace(a[0],"").replace(/^\//,"").replace(/\/$/,""),t[d].childRoutes&&!i?(n=t[d],t=t[d].childRoutes):i||(u.call(this,e,o),e="");break}}if(i)t[r].routeData=f,t[r].active=!0,n&&(t[r].getParent=function(){return h(n)}),t[r].controller(),l.call(this,c);else if(!a){u.call(this,e,o),l.call(this,c),e="";break}}}function d(e,t){for(var n=this.routes,o={};e.length;)for(var i in n){var r=e.match("^"+i);if(e.length&&r){e=e.replace(r[0],"").replace(/^\//,"").replace(/\/$/,""),o=n[i],n=n[i].childRoutes||n[i];break}}"undefined"==typeof o.childRoutes&&(o.childRoutes={}),t.path=t.path.substring(t.path.indexOf("]")+1).replace(/^\//,"").replace(/\/$/,""),o.childRoutes[t.path]={},o.childRoutes[t.path].controller=t.controller}function g(){return n({},this.routes)}function p(e){return""===e&&(e="/"),e=e.replace(/^(\/?[\#\!\?]+)/,"").replace(/$\//,""),this.config.basePath.length&&(e=e.replace(this.config.basePath,"")),e}function w(e){var t=e.indexOf("[")+1,n=e.indexOf("]");return e.substring(t,n)}function v(e){return window.location.origin?e.replace(window.location.origin,""):e.replace(window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),"")}function m(e){for(;e;){if(e instanceof HTMLAnchorElement)return e;e=e.parentNode}return!1}function b(e){e=window.e||e;var t=e.target,n="",o="",i="",r="";return"A"!==t.tagName&&(t=m(t)),!t||(n=t.getAttribute("href"),o=t.getAttribute("target"),n.indexOf(":")>-1&&!n.match(/(?:https?):/)||"_blank"===o||n.match(/(?:https?):/)&&-1===n.indexOf(window.location.hostname))?void 0:(r=v(n),i=p.call(this,r),history.pushState(null,null,r),e.preventDefault(),""===i?"/":i)}function y(){var e=this;if(!this.config.listenerActive){"HIGH"===this.config.loggingLevel&&B.debug("Listener is now active.");var t=H?window.addEventListener:window.attachEvent,n=H?document.addEventListener:document.attachEvent,o=this.config.useHistory&&x?window.location.pathname:window.location.hash;this.config.listenerActive=!0,n("click",function(t){window.LodeVar.previousPath=p.call(e,v(window.location.href))}),this.config.useHistory&&x?this.config.useHistory&&x&&("HIGH"===this.config.loggingLevel&&B.debug("Listening for clicks or popstate."),n("click",function(t){var n=b.call(e,t);n&&e.resolve(n)}),t("popstate",function(){e.resolve(p.call(e,window.location.pathname))})):("HIGH"===this.config.loggingLevel&&B.debug("Listening for hash changes."),t(H?"hashchange":"onhashchange",function(){e.resolve(p.call(e,window.location.hash))})),this.resolve(p.call(this,o))}}function E(e){if(this.config.usingMap===!1)throw new Error("Do not use map() as well as createRoute().");for(var t in e)this.routes[t]=e[t];this.config.usingMap=!0,y.call(this)}function L(e){var t=this;if(this.config.usingMap===!0)throw new Error("Do not use createRoute() as well as map().");if(!e)throw new Error("No route object defined.");if(!e.path)throw new Error("Please define the route to use.");if(!e.controller||"function"!=typeof e.controller)throw new Error("Please define the function that should be executed.");var n="";e.path.indexOf("[")>-1?(n=w(e.path),d.call(this,n,e)):(e.path=p.call(this,e.path),this.routes[e.path]={},this.routes[e.path].controller=e.controller),""===this.config.usingMap&&setTimeout(function(){y.call(t)},0),this.config.usingMap=!1}function R(e){i(this),r(this,e),a()}var D="undefined"!=typeof console,G=!!console.groupCollapsed,x=!(!window.history||!history.pushState),H=!!window.addEventListener,U={DEBUG:!0},k={useHistory:!1,basePath:"",loggingLevel:"LOW",usingMap:"",listenerActive:!1},B={};B.debug=function(){D&&U.DEBUG&&console.debug.apply(console,arguments)},B.log=function(){D&&U.DEBUG&&console.log.apply(console,arguments)},B.warn=function(){D&&U.DEBUG&&console.warn.apply(console,arguments)};var O=["LodestarJs-Router 1.0.4 in debug mode."],P="\n\nHello, you are running the LodestarJs Router 1.0.4 in debug mode.\nThis will help you to identify any problems in your application.\n\nDEBUG mode is a global option, to disable debug mode will disable it for each\ninstance. You can disable it when declaring a new instance. For example,\nnew Router({DEBUG: false});\n\nFor documentation head to the wiki:\n  https://github.com/lodestarjs/lodestar-router/wiki\n\nIf you have found any bugs, create an issue for us:\n  https://github.com/lodestarjs/lodestar-router/issues\n\n";return R.prototype={createRoute:L,map:E,getRoutes:g,resolve:f,notFound:function(e){this.userNotFound=e}},R});
//# sourceMappingURL=router.min.js.map
