!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Router=t()}(this,function(){"use strict";function e(t,o,i){for(var r=0,a=o.length;a>r;r++){var l=o[r];if(!n(l))return;for(var c=Object.keys(l),s=0,u=c.length;u>s;s++){var h=c[s],f=l[h];n(f)&&i?(n(t[h])||(t[h]=Array.isArray(f)?[]:{}),e(t[h],[f],!0)):t[h]=f}}return t}function t(t,o){return e(t,[o],!1)}function o(t,o){return e(t,[o],!0)}function n(e){return null!==e&&"object"==typeof e}function i(e){e.routes={},e.config=t({},x),window.LodeVar=window.LodeVar||{}}function r(t,n){return n&&("undefined"!=typeof n.DEBUG&&(U=o({},{DEBUG:n.DEBUG})),delete n.DEBUG,n.loggingLevel&&(n.loggingLevel=n.loggingLevel.toUpperCase()),t.config=e({},[t.config,n],!0)),t.config}function a(){R&&U.DEBUG&&(console[D?"groupCollapsed":"log"].apply(console,O),console.log(k),D&&console.groupEnd(O))}function l(e,t){B.warn("Route "+e+" of "+t+" not found.")}function c(e,t){for(var o=Object.getOwnPropertyNames(t),n=0,i=o.length;i>n;n++)o[n]!==e&&(t[o[n]].active=!1,t[o[n]].childRoutes&&c(!1,t[o[n]].childRoutes))}function s(e,t){var o={};t.shift();for(var n=0,i=t.length;i>n;n++)o[t[n].replace(/\//g,"")]=e.match(/[^\/]*/g)[0!==n?n+n:n];return o}function u(e,t){"undefined"!=typeof this.userNotFound&&this.userNotFound(),l(e,t)}function h(e){if(e)for(var t=this.routes,o=e,n=!1,i="",r=!1;e.length;){var a={};for(var l in t){var h=!1;if(i=l,l.indexOf(":")>-1){var f=l.split(":");f.length>2?(a=s(e,f),h=l.replace(/\:[^\/]*/g,"[^\\/]*")):(a[l.replace(":","")]=e.match(/[^\/]*/)[0],h=/[^\/]*/)}if(l.match(/\*[a-z]+/i)&&(a[l.replace(/\*[a-z]+/i,"")]=e.match(/.*/)[0].split("/"),h=/.*/),r=e.match("^"+(h||l)),n=r&&0===e.replace(r[0],"").replace(/^\//,"").replace(/\/$/,"").length?!0:!1,e.length&&r){t[l].active||n||(t[l].routeData=a,t[l].active=!0,t[l].controller()),e=e.replace(r[0],"").replace(/^\//,"").replace(/\/$/,""),t[l]&&c(l,t),t[l].childRoutes&&!n?t=t[l].childRoutes:n||(u.call(this,e,o),e="");break}}if(n)t[i].routeData=a,t[i].active=!0,t[i].controller();else if(!r){u.call(this,e,o),e="";break}}}function f(e,t){for(var o=this.routes,n={};e.length;)for(var i in o){var r=e.match("^"+i);if(e.length&&r){e=e.replace(r[0],"").replace(/^\//,"").replace(/\/$/,""),n=o[i],o=o[i].childRoutes||o[i];break}}"undefined"==typeof n.childRoutes&&(n.childRoutes={}),t.path=t.path.substring(t.path.indexOf("]")+1).replace(/^\//,"").replace(/\/$/,""),n.childRoutes[t.path]={},n.childRoutes[t.path].controller=t.controller}function d(){return o({},this.routes)}function g(e){return""===e&&(e="/"),e=e.replace(/^(\/?[\#\!\?]+)/,"").replace(/$\//,""),this.config.basePath.length&&(e=e.replace(this.config.basePath,"")),e}function p(e){var t=e.indexOf("[")+1,o=e.indexOf("]");return e.substring(t,o)}function w(e){return window.location.origin?e.replace(window.location.origin,""):e.replace(window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),"")}function v(e){for(;e;){if(e instanceof HTMLAnchorElement)return e;e=e.parentNode}return!1}function m(e){e=window.e||e;var t=e.target,o="",n="",i="";return"A"!==t.tagName&&(t=v(t)),!t||(o=t.getAttribute("href"),"_blank"===o||o.indexOf(":")>-1&&!o.match(/(?:https?):/)||o.match(/(?:https?):/)&&-1===o.indexOf(window.location.hostname))?void 0:(i=w(o),n=g.call(this,i),history.pushState(null,null,i),e.preventDefault(),n)}function b(){var e=this;if(!this.config.listenerActive){"HIGH"===this.config.loggingLevel&&B.debug("Listener is now active.");var t=H?window.addEventListener:window.attachEvent,o=H?document.addEventListener:document.attachEvent,n=this.config.useHistory&&G?window.location.pathname:window.location.hash;this.config.listenerActive=!0,o("click",function(t){window.LodeVar.previousPath=g.call(e,w(window.location.href))}),this.config.useHistory&&G?this.config.useHistory&&G&&("HIGH"===this.config.loggingLevel&&B.debug("Listening for clicks or popstate."),o("click",function(t){e.resolve(m.call(e,t))}),t("popstate",function(){e.resolve(g.call(e,window.location.pathname))})):("HIGH"===this.config.loggingLevel&&B.debug("Listening for hash changes."),t(H?"hashchange":"onhashchange",function(){e.resolve(g.call(e,window.location.hash))})),this.resolve(g.call(this,n))}}function y(e){if(this.config.usingMap===!1)throw new Error("Do not use map() as well as createRoute().");for(var t in e)this.routes[t]=e[t];this.config.usingMap=!0,b.call(this)}function E(e){var t=this;if(this.config.usingMap===!0)throw new Error("Do not use createRoute() as well as map().");if(!e)throw new Error("No route object defined.");if(!e.path)throw new Error("Please define the route to use.");if(!e.controller||"function"!=typeof e.controller)throw new Error("Please define the function that should be executed.");var o="";e.path.indexOf("[")>-1?(o=p(e.path),f.call(this,o,e)):(e.path=g.call(this,e.path),this.routes[e.path]={},this.routes[e.path].controller=e.controller),""===this.config.usingMap&&setTimeout(function(){b.call(t)},0),this.config.usingMap=!1}function L(e){i(this),r(this,e),a()}var R="undefined"!=typeof console,D=!!console.groupCollapsed,G=!(!window.history||!history.pushState),H=!!window.addEventListener,U={DEBUG:!0},x={useHistory:!1,basePath:"",loggingLevel:"LOW",usingMap:"",listenerActive:!1},B={};B.debug=function(){R&&U.DEBUG&&console.debug.apply(console,arguments)},B.log=function(){R&&U.DEBUG&&console.log.apply(console,arguments)},B.warn=function(){R&&U.DEBUG&&console.warn.apply(console,arguments)};var O=["LodestarJs-Router 1.0.2 in debug mode."],k="\n\nHello, you are running the LodestarJs Router 1.0.2 in debug mode.\nThis will help you to identify any problems in your application.\n\nDEBUG mode is a global option, to disable debug mode will disable it for each\ninstance. You can disable it when declaring a new instance. For example,\nnew Router({DEBUG: false});\n\nFor documentation head to the wiki:\n  https://github.com/lodestarjs/lodestar-router/wiki\n\nIf you have found any bugs, create an issue for us:\n  https://github.com/lodestarjs/lodestar-router/issues\n\n";return L.prototype={createRoute:E,map:y,getRoutes:d,resolve:h,notFound:function(e){this.userNotFound=e}},L});
//# sourceMappingURL=router.min.js.map
